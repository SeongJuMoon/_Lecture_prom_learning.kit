prometheus:
  prometheusSpec:
    additionalScrapeConfigs:
    - job_name: "prometheus-blackbox-kubernetes-healthcheck-services"
      metrics_path: /probe
      params:
        module: [http_2xx]
        target:
         - health
      kubernetes_sd_configs:
      - role: service
      relabel_configs:
        - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_blackbox]
          action: keep
          regex: true   
        - source_labels:
          - __address__
          - __meta_kubernetes_service_annotation_prometheus_io_healthcheck_path 
          regex: (.*);(.*)
          replacement: http://$1$2
          target_label: __param_target
        - target_label: __address__
          replacement:  prometheus-blackbox-exporter.monitoring.svc.cluster.local:9115
        - source_labels: [__param_target]
          target_label: instance
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - source_labels: [__meta_kubernetes_namespace]
          target_label: kubernetes_namespace
        - source_labels: [__meta_kubernetes_service_name]
          target_label: kubernetes_service_name
    